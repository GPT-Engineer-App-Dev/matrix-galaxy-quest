<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Matrix Space Game</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #000;
      color: #0f0;
      font-family: 'Courier New', monospace;
    }
    #game-container {
      width: 100vw;
      height: 100vh;
      position: relative;
    }
    #score {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 20px;
    }
    #player {
      width: 40px;
      height: 40px;
      background-color: #0f0;
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      animation: pulse 1s infinite alternate;
    }
    @keyframes pulse {
      from { box-shadow: 0 0 10px #0f0; }
      to { box-shadow: 0 0 20px #0f0, 0 0 40px #0f0; }
    }
    .planet {
      position: absolute;
      border-radius: 50%;
      background-color: rgba(0, 255, 0, 0.3);
      box-shadow: 0 0 10px #0f0;
    }
    .alien {
      position: absolute;
      width: 30px;
      height: 30px;
      background-color: #f00;
      clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
    }
    .projectile {
      position: absolute;
      width: 5px;
      height: 15px;
      background-color: #0f0;
    }
    .matrix-bg {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
      z-index: -1;
    }
    .matrix-column {
      position: absolute;
      top: -100%;
      width: 20px;
      font-size: 20px;
      text-align: center;
      animation: fall 20s infinite linear;
    }
    @keyframes fall {
      to {
        transform: translateY(100vh);
      }
    }
  </style>
</head>

<body>
  <div id="game-container">
    <div id="score">Score: <span id="score-value">0</span></div>
    <div id="player"></div>
  </div>
  <script>
    const gameContainer = document.getElementById('game-container');
    const player = document.getElementById('player');
    const scoreElement = document.getElementById('score-value');
    let score = 0;
    let projectiles = [];
    let powerUpActive = false;

    function shoot() {
      const projectileCount = powerUpActive ? 3 : 1;
      for (let i = 0; i < projectileCount; i++) {
        createProjectile(i - 1);
      }
    }

    function createProjectile(offset = 0) {
      const projectile = document.createElement('div');
      projectile.className = 'projectile';
      const playerRect = player.getBoundingClientRect();
      projectile.style.left = `${playerRect.left + playerRect.width / 2 - 2.5}px`;
      projectile.style.bottom = `${window.innerHeight - playerRect.top}px`;
      gameContainer.appendChild(projectile);
      projectiles.push(projectile);
    }

    function moveProjectiles() {
      projectiles.forEach((projectile, index) => {
        const top = window.innerHeight - projectile.offsetTop;
        if (top > window.innerHeight) {
          projectile.remove();
          projectiles.splice(index, 1);
        } else {
          projectile.style.bottom = `${top + 5}px`;
        }
      });
      requestAnimationFrame(moveProjectiles);
    }

    function createMatrixBackground() {
      const matrixBg = document.createElement('div');
      matrixBg.className = 'matrix-bg';
      for (let i = 0; i < 100; i++) {
        const column = document.createElement('div');
        column.className = 'matrix-column';
        column.style.left = `${Math.random() * 100}%`;
        column.style.animationDuration = `${5 + Math.random() * 10}s`;
        column.style.opacity = Math.random() * 0.5 + 0.5;
        column.textContent = Array.from({length: 50}, () => Math.random() > 0.5 ? '1' : '0').join('');
        matrixBg.appendChild(column);
      }
      gameContainer.appendChild(matrixBg);
    }

    function createPlanet() {
      const planet = document.createElement('div');
      planet.className = 'planet';
      const size = Math.random() * 100 + 50;
      planet.style.width = `${size}px`;
      planet.style.height = `${size}px`;
      planet.style.left = `${Math.random() * (window.innerWidth - size)}px`;
      planet.style.top = `-${size}px`;
      gameContainer.appendChild(planet);

      const speed = Math.random() * 2 + 1;
      function movePlanet() {
        const top = planet.offsetTop;
        if (top > window.innerHeight) {
          planet.remove();
        } else {
          planet.style.top = `${top + speed}px`;
          requestAnimationFrame(movePlanet);
        }
      }
      requestAnimationFrame(movePlanet);
    }

    function createAlien() {
      const alien = document.createElement('div');
      alien.className = 'alien';
      alien.style.left = `${Math.random() * (window.innerWidth - 30)}px`;
      alien.style.top = '-30px';
      gameContainer.appendChild(alien);

      const speed = Math.random() * 3 + 2;
      function moveAlien() {
        const top = alien.offsetTop;
        if (top > window.innerHeight) {
          alien.remove();
        } else {
          alien.style.top = `${top + speed}px`;
          checkCollision(alien);
          requestAnimationFrame(moveAlien);
        }
      }
      requestAnimationFrame(moveAlien);
    }

    function screenShake() {
      gameContainer.style.transform = `translate(${Math.random() * 10 - 5}px, ${Math.random() * 10 - 5}px)`;
      setTimeout(() => {
        gameContainer.style.transform = 'translate(0, 0)';
      }, 50);
    }

    function checkCollision(alien) {
      const playerRect = player.getBoundingClientRect();
      const alienRect = alien.getBoundingClientRect();

      projectiles.forEach((projectile, index) => {
        const projectileRect = projectile.getBoundingClientRect();
        if (
          projectileRect.left < alienRect.right &&
          projectileRect.right > alienRect.left &&
          projectileRect.top < alienRect.bottom &&
          projectileRect.bottom > alienRect.top
        ) {
          alien.remove();
          projectile.remove();
          projectiles.splice(index, 1);
          score += 10;
          scoreElement.textContent = score;
          screenShake();
          return;
        }
      });

      if (
        playerRect.left < alienRect.right &&
        playerRect.right > alienRect.left &&
        playerRect.top < alienRect.bottom &&
        playerRect.bottom > alienRect.top
      ) {
        alien.remove();
        score -= 20;
        scoreElement.textContent = score;
        screenShake();
      }
    }

    function movePlayer(e) {
      const x = e.clientX || e.touches[0].clientX;
      player.style.left = `${x - 20}px`;
    }

    function createPowerUp() {
      const powerUp = document.createElement('div');
      powerUp.className = 'power-up';
      powerUp.style.left = `${Math.random() * (window.innerWidth - 30)}px`;
      powerUp.style.top = '-30px';
      gameContainer.appendChild(powerUp);

      function movePowerUp() {
        const top = powerUp.offsetTop;
        if (top > window.innerHeight) {
          powerUp.remove();
        } else {
          powerUp.style.top = `${top + 2}px`;
          checkPowerUpCollision(powerUp);
          requestAnimationFrame(movePowerUp);
        }
      }
      requestAnimationFrame(movePowerUp);
    }

    function checkPowerUpCollision(powerUp) {
      const playerRect = player.getBoundingClientRect();
      const powerUpRect = powerUp.getBoundingClientRect();

      if (
        playerRect.left < powerUpRect.right &&
        playerRect.right > powerUpRect.left &&
        playerRect.top < powerUpRect.bottom &&
        playerRect.bottom > powerUpRect.top
      ) {
        powerUp.remove();
        activatePowerUp();
      }
    }

    function activatePowerUp() {
      powerUpActive = true;
      player.style.backgroundColor = '#ff0';
      setTimeout(() => {
        powerUpActive = false;
        player.style.backgroundColor = '#0f0';
      }, 10000);
    }

    createMatrixBackground();
    setInterval(createPlanet, 5000);
    setInterval(createAlien, 1000);
    setInterval(() => {
      createAlien();
      createAlien();
    }, 5000);
    setInterval(createPowerUp, 15000);
    moveProjectiles();

    gameContainer.addEventListener('mousemove', movePlayer);
    gameContainer.addEventListener('touchmove', movePlayer);
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        shoot();
      }
    });
    gameContainer.addEventListener('click', shoot);
  </script>
</body>

</html>
